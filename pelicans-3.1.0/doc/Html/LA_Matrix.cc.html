<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">
<html>
<head>
  <title>LA_Matrix.cc</title>
  <link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
</head>
<script>
  function asd()
  {
    parent.document.title="LA_Matrix.cc_PELICANS 17_03_2010 ";
  }
</script> 

<body onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<div id=navbar>
  <a name="navbar_top_firstrow"><!-- --></a>
  <div id=navbarapp>PELICANS 17_03_2010</div>
  <div id=navbarmenu>
    <a href="LApack-tree.html"><span>Tree</span></a>
    <a href="LA_Matrix.html"><span>Class</span></a>
    <a href="LA_Matrix.hh.html"><span>Header</span></a>
    <span class=selected>Implementation</span>
    <a href="LA_Matrix.icc.html"><span>Inlined</span></a>
    <div id=navbarsub>
      <a href="index.html" target="_top">FRAMES :</a>
      <a href="LApack-tree.html" target="_top">: NO FRAMES</a>
    </div>
  </div>
</div>
<!-- ========== END OF NAVBAR ========== -->

<pre>
<font class="comment">/*
 *  Copyright 1995-2010 by IRSN
 *
 *  This software is an application framework, with a set of integrated
 *  reusable components, whose purpose is to simplify the task of developing
 *  softwares of numerical mathematics and scientific computing.
 *
 *  This software is governed by the CeCILL-C license under French law and
 *  abiding by the rules of distribution of free software. You can use, modify
 *  and/or redistribute the software under the terms of the CeCILL-C license
 *  as circulated by CEA, CNRS and INRIA at the following URL
 *  &quot;http://www.cecill.info&quot;.
 *
 *  As a counterpart to the access to the source code and rights to copy,
 *  modify and redistribute granted by the license, users are provided only
 *  with a limited warranty and the software's author, the holder of the
 *  economic rights, and the successive licensors have only limited liability.
 *
 *  In this respect, the user's attention is drawn to the risks associated
 *  with loading, using, modifying and/or developing or reproducing the
 *  software by the user in light of its specific status of free software,
 *  that may mean that it is complicated to manipulate, and that also
 *  therefore means that it is reserved for developers and experienced
 *  professionals having in-depth computer knowledge. Users are therefore
 *  encouraged to load and test the software's suitability as regards their
 *  requirements in conditions enabling the security of their systems and/or
 *  data to be ensured and, more generally, to use and operate it in the same
 *  conditions as regards security.
 *
 *  The fact that you are presently reading this means that you have had
 *  knowledge of the CeCILL-C license and that you accept its terms.
 */
</font><font class="text">
</font><font class="kw2">#include</font><font class="text"> &lt;</font><font class="kw3">LA_Matrix</font><font class="text">.hh&gt;

</font><font class="kw2">#include</font><font class="text"> &lt;fstream&gt;
</font><font class="kw2">#include</font><font class="text"> &lt;iomanip&gt;

</font><font class="kw2">#include</font><font class="text"> &lt;</font><font class="kw3">LA_SeqMatrix</font><font class="text">.hh&gt;
</font><font class="kw2">#include</font><font class="text"> &lt;</font><font class="kw3">LA_MatrixIterator</font><font class="text">.hh&gt;
</font><font class="kw2">#include</font><font class="text"> &lt;</font><font class="kw3">LA_Vector</font><font class="text">.hh&gt;

</font><font class="kw2">#include</font><font class="text"> &lt;</font><font class="kw3">PEL</font><font class="text">.hh&gt;
</font><font class="kw2">#include</font><font class="text"> &lt;</font><font class="kw3">PEL_assertions</font><font class="text">.hh&gt;
</font><font class="kw2">#include</font><font class="text"> &lt;</font><font class="kw3">PEL_Communicator</font><font class="text">.hh&gt;
</font><font class="kw2">#include</font><font class="text"> &lt;</font><font class="kw3">PEL_DistributedPartition</font><font class="text">.hh&gt;
</font><font class="kw2">#include</font><font class="text"> &lt;</font><font class="kw3">PEL_Error</font><font class="text">.hh&gt;
</font><font class="kw2">#include</font><font class="text"> &lt;</font><font class="kw3">PEL_Exec</font><font class="text">.hh&gt;
</font><font class="kw2">#include</font><font class="text"> &lt;</font><font class="kw3">PEL_ModuleExplorer</font><font class="text">.hh&gt;
</font><font class="kw2">#include</font><font class="text"> &lt;</font><font class="kw3">PEL_ObjectRegister</font><font class="text">.hh&gt;
</font><font class="kw2">#include</font><font class="text"> &lt;</font><font class="kw3">PEL_Root</font><font class="text">.hh&gt;

</font><font class="kw2">#ifdef</font><font class="text"> OUTLINE
</font><font class="kw2">#define</font><font class="text"> </font><font class="kw1">inline
</font><font class="text">   </font><font class="kw2">#include</font><font class="text"> &lt;</font><font class="kw3">LA_Matrix</font><font class="text">.icc&gt;
#undef </font><font class="kw1">inline
</font><font class="kw2">#endif
</font><font class="text">
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw3">LA_Matrix</font><font class="text">*
</font><font class="kw3">LA_Matrix</font><font class="text">:: make( </font><font class="kw3">PEL_Object</font><font class="text">* a_owner,
                  </font><font class="kw3">PEL_ModuleExplorer</font><font class="text"> </font><font class="kw1">const</font><font class="text">* exp )
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: make&quot;</font><font class="text"> ) ;
   </font><font class="kw3">PEL_CHECK_PRE</font><font class="text">( exp != 0 ) ;

   </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">string</font><font class="text"> name = exp-&gt;string_data( </font><font class="string">&quot;concrete_name&quot;</font><font class="text"> ) ;
   </font><font class="kw3">LA_Matrix</font><font class="text"> </font><font class="kw1">const</font><font class="text">* proto =
      </font><font class="kw1">static_cast</font><font class="text">&lt;</font><font class="kw3">LA_Matrix</font><font class="text"> </font><font class="kw1">const</font><font class="text">*&gt;( plugins_map()-&gt;item( name ) ) ;

   </font><font class="kw3">PEL_ASSERT</font><font class="text">( proto!=0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( proto-&gt;is_a_prototype() ) ;

   </font><font class="kw3">LA_Matrix</font><font class="text">* result = proto-&gt;create_replica( a_owner, exp ) ;

   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( result != 0 ) ;
   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( result-&gt;owner() == a_owner ) ;
   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( result-&gt;name() == exp-&gt;string_data( </font><font class="string">&quot;concrete_name&quot;</font><font class="text"> ) ) ;
   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( result-&gt;is_desynchronizable(),
                            result-&gt;state() == </font><font class="kw3">LA</font><font class="text">::NotSync_undef ) ) ;
   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( result-&gt;distribution_strategy() !=
                   </font><font class="kw3">LA</font><font class="text">::InvalidDistribution ) ;
   </font><font class="kw1">return</font><font class="text">( result ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw3">LA_Matrix</font><font class="text">:: </font><font class="kw3">LA_Matrix</font><font class="text">( </font><font class="kw3">PEL_Object</font><font class="text">* a_owner, 
                       </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">string</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; a_name,
                       </font><font class="kw3">LA</font><font class="text">::DistributionStrategy a_dist_strat )
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">   : </font><font class="kw3">PEL_Object</font><font class="text">( a_owner )
   , IS_PROTO( </font><font class="kw1">false</font><font class="text"> )
   , NAME( a_name )
   , SYNC_STATE( </font><font class="kw3">LA</font><font class="text">::Sync )
   , RESIZABLE( </font><font class="kw1">true</font><font class="text"> )
   , ONLY_LOCAL_MODIFS( </font><font class="kw1">false</font><font class="text"> )
   , DIST_STRAT( a_dist_strat )
{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: LA_Matrix&quot;</font><font class="text"> ) ;
   </font><font class="kw3">PEL_CHECK_PRE</font><font class="text">( !a_name.empty() ) ;

   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( !is_a_prototype() ) ;
   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( owner() == a_owner ) ;
   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( name() == a_name ) ;
   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( is_resizable() ) ;
   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( distribution_strategy() == a_dist_strat ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw3">LA_Matrix</font><font class="text">:: </font><font class="kw3">LA_Matrix</font><font class="text">( </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">string</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; a_name )
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">   : </font><font class="kw3">PEL_Object</font><font class="text">( plugins_map() )
   , IS_PROTO( </font><font class="kw1">true</font><font class="text"> )
   , NAME( a_name )
   , SYNC_STATE( </font><font class="kw3">LA</font><font class="text">::Sync )
   , RESIZABLE( </font><font class="kw1">false</font><font class="text"> )
   , ONLY_LOCAL_MODIFS( </font><font class="kw1">false</font><font class="text"> )
   , DIST_STRAT( </font><font class="kw3">LA</font><font class="text">::InvalidDistribution )
{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: LA_Matrix( prototype )&quot;</font><font class="text"> ) ;
   </font><font class="kw3">PEL_CHECK_PRE</font><font class="text">( !a_name.empty() ) ;

   plugins_map()-&gt;register_item( a_name, </font><font class="kw1">this</font><font class="text"> ) ;

   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( is_a_prototype() ) ;
   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( name() == a_name ) ;
   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( ! is_resizable() ) ;
   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( distribution_strategy() == </font><font class="kw3">LA</font><font class="text">::InvalidDistribution ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw3">LA_Matrix</font><font class="text">:: ~</font><font class="kw3">LA_Matrix</font><font class="text">( </font><font class="kw1">void</font><font class="text"> )
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw2">std</font><font class="text">::</font><font class="kw2">string</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp;
</font><font class="kw3">LA_Matrix</font><font class="text">:: name( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw1">return</font><font class="text">( NAME ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: is_resizable( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw1">return</font><font class="text">( RESIZABLE ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: is_symmetric( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: is_symmetric&quot;</font><font class="text"> ) ;

   </font><font class="kw1">bool</font><font class="text"> result = </font><font class="kw1">false</font><font class="text"> ;

   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( is_symmetric_POST( result ) ) ;
   </font><font class="kw1">return</font><font class="text">( result ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">void
</font><font class="kw3">LA_Matrix</font><font class="text">:: make_non_resizable( </font><font class="kw1">void</font><font class="text"> )
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: make_non_resizable&quot;</font><font class="text"> ) ;

   RESIZABLE = </font><font class="kw1">false</font><font class="text"> ;

   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( !is_resizable() ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: only_local_modifs( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: only_local_modifs&quot;</font><font class="text"> ) ;

   </font><font class="kw1">bool</font><font class="text"> result = ONLY_LOCAL_MODIFS ;

   </font><font class="kw1">return</font><font class="text">( result ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">void
</font><font class="kw3">LA_Matrix</font><font class="text">:: set_only_local_modifs_state( </font><font class="kw1">bool</font><font class="text"> only_local )
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: set_only_local_modifs_state&quot;</font><font class="text"> ) ;

   ONLY_LOCAL_MODIFS = only_local ;

   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( only_local_modifs() == only_local ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">void
</font><font class="kw3">LA_Matrix</font><font class="text">:: start_local_modifs( </font><font class="kw1">void</font><font class="text"> )
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: start_local_modifs&quot;</font><font class="text"> ) ;
   </font><font class="kw3">PEL_CHECK_PRE</font><font class="text">( start_local_modifs_PRE() ) ;

   set_only_local_modifs_state( </font><font class="kw1">true</font><font class="text"> ) ;

   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( start_local_modifs_POST() ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">void
</font><font class="kw3">LA_Matrix</font><font class="text">:: stop_local_modifs( </font><font class="kw1">void</font><font class="text"> )
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: stop_local_modifs&quot;</font><font class="text"> ) ;
   </font><font class="kw3">PEL_CHECK_PRE</font><font class="text">( stop_local_modifs_PRE() ) ;

   set_only_local_modifs_state( </font><font class="kw1">false</font><font class="text"> ) ;

   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( stop_local_modifs_POST() ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw3">LA</font><font class="text">::DistributionStrategy
</font><font class="kw3">LA_Matrix</font><font class="text">:: distribution_strategy( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: distribution_strategy&quot;</font><font class="text"> ) ;

   </font><font class="kw1">return</font><font class="text">( DIST_STRAT ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: is_synchronized( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: is_synchronized&quot;</font><font class="text"> ) ;
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;

   </font><font class="kw1">bool</font><font class="text"> result = ( is_desynchronizable() ?
                      </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;boolean_and(
                                                SYNC_STATE == </font><font class="kw3">LA</font><font class="text">::Sync ) :
                      </font><font class="kw1">true</font><font class="text"> ) ;

   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">(
      </font><font class="kw3">IMPLIES</font><font class="text">( !is_desynchronizable(), result == </font><font class="kw1">true</font><font class="text"> ) ) ;
   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">(
      </font><font class="kw3">IMPLIES</font><font class="text">( is_desynchronizable(),
               result == </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;boolean_and(
                                               state() == </font><font class="kw3">LA</font><font class="text">::Sync ) ) ) ;
   </font><font class="kw1">return</font><font class="text">( result ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw2">size_t
</font><font class="kw3">LA_Matrix</font><font class="text">:: nb_local_rows( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: nb_local_rows&quot;</font><font class="text"> ) ;

   </font><font class="kw2">size_t</font><font class="text"> result = row_distribution()-&gt;local_number() ;

   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( result == row_distribution()-&gt;local_number() ) ;
   </font><font class="kw1">return</font><font class="text">( result ) ;
}


</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw2">size_t
</font><font class="kw3">LA_Matrix</font><font class="text">:: nb_local_cols( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: nb_local_cols&quot;</font><font class="text"> ) ;

   </font><font class="kw2">size_t</font><font class="text"> result = col_distribution()-&gt;local_number() ;

   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( result == col_distribution()-&gt;local_number() ) ;
   </font><font class="kw1">return</font><font class="text">( result ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">void
</font><font class="kw3">LA_Matrix</font><font class="text">:: synchronize( </font><font class="kw1">void</font><font class="text"> )
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: synchronize&quot;</font><font class="text"> ) ;
   </font><font class="kw3">PEL_CHECK_PRE</font><font class="text">( synchronize_PRE() ) ;

   SYNC_STATE = </font><font class="kw3">LA</font><font class="text">::Sync ;

   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( synchronize_POST() ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw3">LA_MatrixIterator</font><font class="text">*
</font><font class="kw3">LA_Matrix</font><font class="text">:: create_stored_item_iterator( </font><font class="kw3">PEL_Object</font><font class="text">* a_owner ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: create_stored_item_iterator&quot;</font><font class="text"> ) ;
   </font><font class="kw3">PEL_CHECK_PRE</font><font class="text">( create_stored_item_iterator_PRE( a_owner ) ) ;

   </font><font class="kw3">LA_SeqMatrix</font><font class="text">* matrix = create_local_matrix( 0 ) ;
   </font><font class="kw3">LA_MatrixIterator</font><font class="text">* result = matrix-&gt;create_stored_item_iterator( a_owner ) ;
   matrix-&gt;set_owner( result ) ;

   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( create_stored_item_iterator_POST( a_owner, result ) ) ;
   </font><font class="kw1">return</font><font class="text">( result ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">void
</font><font class="kw3">LA_Matrix</font><font class="text">:: extract_diag( </font><font class="kw3">LA_Vector</font><font class="text">* diag ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: extract_diag&quot;</font><font class="text"> ) ;
   </font><font class="kw3">PEL_CHECK_PRE</font><font class="text">( extract_diag_PRE( diag ) ) ;

   </font><font class="kw3">PEL_Error</font><font class="text">::object()-&gt;raise_not_implemented( </font><font class="kw1">this</font><font class="text">, </font><font class="string">&quot;extract_diag&quot;</font><font class="text"> ) ;

   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( extract_diag_POST( diag ) ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">void
</font><font class="kw3">LA_Matrix</font><font class="text">:: tr_multiply_vec_then_add(
                        </font><font class="kw3">LA_Vector</font><font class="text"> </font><font class="kw1">const</font><font class="text">* x, </font><font class="kw3">LA_Vector</font><font class="text">* y,
                        </font><font class="kw1">double</font><font class="text"> alpha, </font><font class="kw1">double</font><font class="text"> beta )  </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: tr_multiply_vec_then_add&quot;</font><font class="text"> ) ;
   </font><font class="kw3">PEL_CHECK_PRE</font><font class="text">( tr_multiply_vec_then_add_PRE( x, y, alpha, beta ) ) ;

   </font><font class="kw3">PEL_Error</font><font class="text">::object()-&gt;raise_not_implemented( </font><font class="kw1">this</font><font class="text">,
                                               </font><font class="string">&quot;tr_multiply_vec_then_add&quot;</font><font class="text"> ) ;

   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( tr_multiply_vec_then_add_POST( y ) ) ;
}


</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">void
</font><font class="kw3">LA_Matrix</font><font class="text">:: scale_as_diag_mat_mat( </font><font class="kw3">LA_Vector</font><font class="text"> </font><font class="kw1">const</font><font class="text">* lvec )
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: scale_as_diag_mat_mat&quot;</font><font class="text"> ) ;
   </font><font class="kw3">PEL_CHECK_PRE</font><font class="text">( scale_as_diag_mat_mat_PRE( lvec ) ) ;

   </font><font class="kw3">PEL_Error</font><font class="text">::object()-&gt;raise_not_implemented( </font><font class="kw1">this</font><font class="text">,
                                               </font><font class="string">&quot;scale_as_diag_mat_mat&quot;</font><font class="text"> ) ;

   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( scale_as_diag_mat_mat_POST() ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">void
</font><font class="kw3">LA_Matrix</font><font class="text">:: scale_as_mat_diag_mat( </font><font class="kw3">LA_Vector</font><font class="text"> </font><font class="kw1">const</font><font class="text">* rvec )
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: scale_as_mat_diag_mat&quot;</font><font class="text"> ) ;
   </font><font class="kw3">PEL_CHECK_PRE</font><font class="text">( scale_as_mat_diag_mat_PRE( rvec ) ) ;

   </font><font class="kw3">PEL_Error</font><font class="text">::object()-&gt;raise_not_implemented( </font><font class="kw1">this</font><font class="text">,
                                               </font><font class="string">&quot;scale_as_mat_diag_mat&quot;</font><font class="text"> ) ;

   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( scale_as_mat_diag_mat_POST() ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">void
</font><font class="kw3">LA_Matrix</font><font class="text">:: add_to_diag( </font><font class="kw3">LA_Vector</font><font class="text"> </font><font class="kw1">const</font><font class="text">* vec )
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: add_to_diag&quot;</font><font class="text"> ) ;
   </font><font class="kw3">PEL_CHECK_PRE</font><font class="text">( add_to_diag_PRE( vec ) ) ;
   </font><font class="kw3">PEL_SAVEOLD</font><font class="text">( </font><font class="kw3">LA</font><font class="text">::SyncState, state, state() ) ;

   </font><font class="kw3">PEL_Error</font><font class="text">::object()-&gt;raise_not_implemented( </font><font class="kw1">this</font><font class="text">, </font><font class="string">&quot;add_to_diag&quot;</font><font class="text"> ) ;

   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( add_to_diag_POST( </font><font class="kw3">OLD</font><font class="text">( state ) ) ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">void
</font><font class="kw3">LA_Matrix</font><font class="text">:: </font><font class="kw2">set</font><font class="text">( </font><font class="kw3">LA_Matrix</font><font class="text"> </font><font class="kw1">const</font><font class="text">* A, </font><font class="kw1">bool</font><font class="text"> same_pattern )
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: set&quot;</font><font class="text"> ) ;
   </font><font class="kw3">PEL_CHECK_PRE</font><font class="text">( set_PRE( A, same_pattern ) ) ;

   nullify() ;
   add_Mat( A, 1.0, same_pattern ) ;
   </font><font class="comment">//synchronize() ;
</font><font class="text">
   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( set_POST( A ) ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">void
</font><font class="kw3">LA_Matrix</font><font class="text">:: add_tMat( </font><font class="kw3">LA_Matrix</font><font class="text"> </font><font class="kw1">const</font><font class="text">* A, </font><font class="kw1">double</font><font class="text"> alpha )
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: add_tMat&quot;</font><font class="text"> ) ;
   </font><font class="kw3">PEL_CHECK_PRE</font><font class="text">( add_tMat_PRE( A, alpha ) ) ;
   </font><font class="kw3">PEL_SAVEOLD</font><font class="text">( </font><font class="kw3">LA</font><font class="text">::SyncState, state, state() ) ;

   </font><font class="kw3">PEL_Error</font><font class="text">::object()-&gt;raise_not_implemented( </font><font class="kw1">this</font><font class="text">, </font><font class="string">&quot;add_tMat&quot;</font><font class="text"> ) ;

   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( add_tMat_POST( </font><font class="kw3">OLD</font><font class="text">( state ) ) ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">void
</font><font class="kw3">LA_Matrix</font><font class="text">:: add_Mat_Mat( </font><font class="kw3">LA_Matrix</font><font class="text"> </font><font class="kw1">const</font><font class="text">* A, </font><font class="kw3">LA_Matrix</font><font class="text"> </font><font class="kw1">const</font><font class="text">* B,
                         </font><font class="kw1">double</font><font class="text"> alpha )
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: add_Mat_Mat&quot;</font><font class="text"> ) ;
   </font><font class="kw3">PEL_CHECK_PRE</font><font class="text">( add_Mat_Mat_PRE( A, B, alpha ) ) ;
   </font><font class="kw3">PEL_SAVEOLD</font><font class="text">( </font><font class="kw3">LA</font><font class="text">::SyncState, state, state() ) ;

   </font><font class="kw3">PEL_Error</font><font class="text">::object()-&gt;raise_not_implemented( </font><font class="kw1">this</font><font class="text">, </font><font class="string">&quot;add_Mat_Mat&quot;</font><font class="text"> ) ;

   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( add_Mat_Mat_POST( </font><font class="kw3">OLD</font><font class="text">( state ) ) ) ;
}
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">void
</font><font class="kw3">LA_Matrix</font><font class="text">:: readMM( </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">string</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; file )
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: readMM&quot;</font><font class="text"> ) ;
   </font><font class="kw3">PEL_CHECK_PRE</font><font class="text">( readMM_PRE( file ) ) ;
   </font><font class="kw3">PEL_CHECK_INV</font><font class="text">( invariant() ) ;

   </font><font class="kw1">if</font><font class="text">( !is_resizable() )
   {
      </font><font class="kw3">PEL_Error</font><font class="text">::object()-&gt;raise_internal(
         </font><font class="string">&quot;Reading of non resizable matrix is not implemented&quot;</font><font class="text"> ) ;
   }

   </font><font class="kw2">std</font><font class="text">::ifstream in( file.c_str(), </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">ios_base</font><font class="text">::binary ) ; </font><font class="comment">//???
</font><font class="text">   </font><font class="kw1">if</font><font class="text">( !in )
   {
      </font><font class="kw3">PEL_Error</font><font class="text">::object()-&gt;raise_file_handling( file, </font><font class="string">&quot;open&quot;</font><font class="text"> ) ;
   }
   </font><font class="kw1">bool</font><font class="text"> array, sym ;
   </font><font class="kw2">size_t</font><font class="text"> n, m, p ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( readMMHeader( in, array, sym, n, m, p ) ) ;
   </font><font class="kw1">if</font><font class="text">( n*m == 0 &amp;&amp; ( n&gt;0 || m&gt;0 ) )
   {
      </font><font class="kw3">PEL_Error</font><font class="text">::object()-&gt;raise_plain(
         </font><font class="string">&quot;*** LA_Matrix:: readMM error:\n&quot;
</font><font class="text">         </font><font class="string">&quot;    Bad number of row and column in file &quot;</font><font class="text">+file ) ;
   }
   </font><font class="kw1">if</font><font class="text">( is_symmetric() &amp;&amp; !sym )
   {
      </font><font class="kw3">PEL_Error</font><font class="text">::object()-&gt;raise_plain(
         </font><font class="string">&quot;*** LA_Matrix:: readMM error:\n&quot;
</font><font class="text">         </font><font class="string">&quot;    No symmetric matrix in file &quot;</font><font class="text">+file+</font><font class="string">&quot;\n&quot;
</font><font class="text">         </font><font class="string">&quot;    can't be read by a symmetric one&quot;</font><font class="text"> ) ;
   }
   </font><font class="kw1">if</font><font class="text">( sym &amp;&amp; n!=m )
   {
      </font><font class="kw3">PEL_Error</font><font class="text">::object()-&gt;raise_plain(
         </font><font class="string">&quot;*** LA_Matrix:: readMM error:\n&quot;
</font><font class="text">         </font><font class="string">&quot;    Symmetric matrix not square in file &quot;</font><font class="text">+file ) ;
   }

   re_initialize( n, m ) ;

   </font><font class="kw1">double</font><font class="text"> v ;
   </font><font class="kw2">size_t</font><font class="text"> nb = ( is_desynchronizable() ? 
                    </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;nb_ranks() : 1 ) ; </font><font class="comment">//???
</font><font class="text">   </font><font class="kw2">size_t</font><font class="text"> r =  ( is_desynchronizable() ? 
                    </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;rank() : 0 ) ; </font><font class="comment">//???
</font><font class="text">   </font><font class="kw2">size_t</font><font class="text"> s = p / nb ;
   </font><font class="kw2">size_t</font><font class="text"> first = r*s ;
   </font><font class="kw2">size_t</font><font class="text"> last = (r+1)*s ;
   </font><font class="kw1">if</font><font class="text">( r==nb-1 ) last = p ;

   </font><font class="kw1">if</font><font class="text">( !array )
   {
      </font><font class="kw2">size_t</font><font class="text"> i, j ;
      </font><font class="kw1">for</font><font class="text">( </font><font class="kw2">size_t</font><font class="text"> k = 0 ; k &lt; last ; k++ )
      {
         in &gt;&gt; i &gt;&gt; j &gt;&gt; v ;
         </font><font class="kw1">if</font><font class="text">( k &gt;= first )
         {
            i-- ;
            j-- ;
            </font><font class="kw1">if</font><font class="text">( sym &amp;&amp; i&lt;j )
            {
               </font><font class="kw3">PEL_Error</font><font class="text">::object()-&gt;raise_plain(
                  </font><font class="string">&quot;*** LA_Matrix:: readMM error:\n&quot;
</font><font class="text">                  </font><font class="string">&quot;    Symmetric matrix in file &quot;</font><font class="text">+file+</font><font class="string">&quot;\n&quot;
</font><font class="text">                  </font><font class="string">&quot;    should contain only terms below the main diagonal&quot;</font><font class="text"> ) ;
            }

            </font><font class="kw1">if</font><font class="text">( is_symmetric() )
            {
               set_item( j, i, v ) ;
            }
            </font><font class="kw1">else
</font><font class="text">            {
               set_item( i, j, v ) ;
               </font><font class="kw1">if</font><font class="text">( sym &amp;&amp; i!=j )
               {
                  set_item( j, i, v ) ;
               }
            }
         }
      }
   }
   </font><font class="kw1">else
</font><font class="text">   {
      </font><font class="kw1">for</font><font class="text">( </font><font class="kw2">size_t</font><font class="text"> j=0 ; j&lt;nb_cols() ; j++ )
      {
         </font><font class="kw2">size_t</font><font class="text"> lower = 0 ;
         </font><font class="kw1">if</font><font class="text">( sym )
         {
            lower = j ;
         }
         </font><font class="kw1">for</font><font class="text">( </font><font class="kw2">size_t</font><font class="text"> i=lower; i&lt;nb_rows() ; i++ )
         {
            in &gt;&gt; v ;
            </font><font class="kw1">if</font><font class="text">( is_symmetric() )
            {
               set_item( j, i, v ) ;
            }
            </font><font class="kw1">else
</font><font class="text">            {
               set_item( i, j, v ) ;
               </font><font class="kw1">if</font><font class="text">( sym &amp;&amp; i!=j )
               {
                  set_item( j, i, v ) ;
               }
            }
         }
      }
   }
   synchronize() ;

   </font><font class="kw3">PEL_CHECK_INV</font><font class="text">( invariant() ) ;
   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( readMM_POST() ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">void
</font><font class="kw3">LA_Matrix</font><font class="text">:: writeMM( </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">string</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; file ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: writeMM&quot;</font><font class="text"> ) ;
   </font><font class="kw3">PEL_CHECK_PRE</font><font class="text">( writeMM_PRE( file ) ) ;
   </font><font class="kw3">PEL_CHECK_INV</font><font class="text">( invariant() ) ;

   </font><font class="kw2">size_t</font><font class="text"> rank = </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;rank() ;
   </font><font class="kw2">size_t</font><font class="text"> size = </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;nb_ranks() ;
   </font><font class="kw1">int</font><font class="text"> dummy ;
   </font><font class="kw3">LA_SeqMatrix</font><font class="text">* mat = create_local_matrix(0) ;
   </font><font class="kw3">LA_MatrixIterator</font><font class="text">* it = mat-&gt;create_stored_item_iterator( mat ) ;
   </font><font class="kw2">size_t</font><font class="text"> total_nb = mat-&gt;nb_stored_items() ;
   </font><font class="kw1">if</font><font class="text">( is_symmetric() )
   {
      total_nb= 0 ;
      </font><font class="kw1">for</font><font class="text">( it-&gt;start_all_items() ; it-&gt;is_valid() ; it-&gt;go_next() )
      {
         </font><font class="kw1">if</font><font class="text">(it-&gt;row()&lt;=it-&gt;col()) total_nb++ ;
      }
   }
   </font><font class="kw1">else
</font><font class="text">   {
      total_nb = mat-&gt;nb_stored_items() ;
   }

   total_nb = (</font><font class="kw2">size_t</font><font class="text">)( </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;sum( total_nb ) ) ;

   </font><font class="kw1">if</font><font class="text">( rank&gt;0 ) </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;receive( rank-1, dummy ) ;

   </font><font class="kw2">std</font><font class="text">::ofstream out(
      file.c_str(),
      ( rank==0 ? </font><font class="kw2">std</font><font class="text">::ios::out : </font><font class="kw2">std</font><font class="text">::ios::out|</font><font class="kw2">std</font><font class="text">::ios::app ) ) ;
   </font><font class="kw1">if</font><font class="text">( !out )
   {
      </font><font class="kw3">PEL_Error</font><font class="text">::object()-&gt;raise_file_handling( file, </font><font class="string">&quot;open&quot;</font><font class="text"> ) ;
   }
   </font><font class="kw1">if</font><font class="text">( rank==0 )
   {
      out &lt;&lt; </font><font class="string">&quot;%%MatrixMarket matrix coordinate real &quot;
</font><font class="text">          &lt;&lt; ( is_symmetric() ? </font><font class="string">&quot;symmetric&quot;</font><font class="text"> : </font><font class="string">&quot;general&quot;</font><font class="text"> ) ;
      out &lt;&lt; </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">endl</font><font class="text"> &lt;&lt; nb_rows() &lt;&lt; </font><font class="string">&quot; &quot;</font><font class="text"> &lt;&lt; nb_cols()
          &lt;&lt; </font><font class="string">&quot; &quot;</font><font class="text"> &lt;&lt; total_nb &lt;&lt; </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">endl</font><font class="text"> ;
   }

   </font><font class="kw1">for</font><font class="text">( it-&gt;start_all_items() ; it-&gt;is_valid() ; it-&gt;go_next() )
   {
      </font><font class="kw1">if</font><font class="text">( !is_symmetric() )
      {
         out &lt;&lt; </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">setprecision</font><font class="text">(16) &lt;&lt; it-&gt;row()+1
             &lt;&lt; </font><font class="string">&quot; &quot;</font><font class="text"> &lt;&lt; it-&gt;col()+1 &lt;&lt; </font><font class="string">&quot; &quot;</font><font class="text"> &lt;&lt; it-&gt;item() &lt;&lt; </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">endl</font><font class="text"> ;
      }
      </font><font class="kw1">else</font><font class="text"> </font><font class="kw1">if</font><font class="text">(it-&gt;row()&lt;=it-&gt;col())
      {
         out &lt;&lt; </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">setprecision</font><font class="text">(16)  &lt;&lt; it-&gt;col()+1
             &lt;&lt; </font><font class="string">&quot; &quot;</font><font class="text"> &lt;&lt; it-&gt;row()+1 &lt;&lt; </font><font class="string">&quot; &quot;</font><font class="text"> &lt;&lt; it-&gt;item() &lt;&lt; </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">endl</font><font class="text"> ;
      }
   }
   mat-&gt;destroy() ;

   out.close() ;

   </font><font class="kw1">if</font><font class="text">( rank!=size-1 )
   {
      </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;send( rank+1, dummy ) ;
      </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;receive( size-1, dummy ) ;
   }
   </font><font class="kw1">else
</font><font class="text">   {
      </font><font class="kw1">for</font><font class="text">( </font><font class="kw2">size_t</font><font class="text"> i=0 ; i&lt;size-1 ; ++i )
         </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;send( i, dummy ) ;
   }

   </font><font class="kw3">PEL_CHECK_INV</font><font class="text">( invariant() ) ;
   </font><font class="kw3">PEL_CHECK_POST</font><font class="text">( writeMM_POST() ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">void
</font><font class="kw3">LA_Matrix</font><font class="text">:: print( </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">ostream</font><font class="text">&amp; os, </font><font class="kw2">size_t</font><font class="text"> indent_width ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">string</font><font class="text"> s( indent_width, </font><font class="string">' '</font><font class="text"> ) ;
   os &lt;&lt; s &lt;&lt; </font><font class="string">&quot;matrix: \&quot;&quot; &lt;&lt; name() &lt;&lt; &quot;</font><font class="text">\</font><font class="string">&quot;&quot;</font><font class="text"> &lt;&lt; </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">endl</font><font class="text"> ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">void
</font><font class="kw3">LA_Matrix</font><font class="text">:: print_items( </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">ostream</font><font class="text">&amp; os, </font><font class="kw2">size_t</font><font class="text"> indent_width ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: print_items&quot;</font><font class="text"> ) ;
   </font><font class="kw3">PEL_CHECK_PRE</font><font class="text">( print_items_PRE( os, indent_width ) ) ;

   </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">string</font><font class="text"> space( indent_width, </font><font class="string">' '</font><font class="text"> ) ;
   os &lt;&lt; space &lt;&lt; </font><font class="string">&quot;nb_rows:&quot;</font><font class="text"> &lt;&lt; nb_rows() &lt;&lt; </font><font class="string">&quot; nb_cols:&quot;</font><font class="text"> &lt;&lt; nb_cols()
      &lt;&lt; </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">endl</font><font class="text"> ;
   </font><font class="kw1">if</font><font class="text">( nb_rows()&gt;0 &amp;&amp; nb_cols()&gt;0 )
   {
      </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">ios_base</font><font class="text">::</font><font class="kw2">fmtflags</font><font class="text"> original_flags = os.flags() ;
      os.setf( </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">ios_base</font><font class="text">::</font><font class="kw2">uppercase</font><font class="text"> | </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">ios_base</font><font class="text">::</font><font class="kw2">scientific</font><font class="text"> ) ;
      </font><font class="kw2">std</font><font class="text">::streamsize p = os.precision() ;
      os &lt;&lt; </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">setprecision</font><font class="text">( 7 ) ;
      </font><font class="kw3">LA_MatrixIterator</font><font class="text">* it = create_stored_item_iterator( 0 ) ;
      </font><font class="kw1">for</font><font class="text">( </font><font class="kw2">size_t</font><font class="text"> i=0 ; i&lt;nb_rows() ; i++ )
      {
         </font><font class="kw1">bool</font><font class="text"> first = </font><font class="kw1">true</font><font class="text"> ;
         </font><font class="kw1">for</font><font class="text">( it-&gt;start_row_items(i) ; it-&gt;is_valid() ; it-&gt;go_next() )
         {
            </font><font class="kw1">if</font><font class="text">( first )
            {
               os &lt;&lt; space &lt;&lt; </font><font class="string">&quot;Rows n&#xB0;&quot;</font><font class="text"> &lt;&lt; i &lt;&lt; </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">endl</font><font class="text"> ;
               first = </font><font class="kw1">false</font><font class="text"> ;
            }
            os &lt;&lt; space
               &lt;&lt; </font><font class="string">&quot;   ( i=&quot;</font><font class="text"> &lt;&lt; i &lt;&lt; </font><font class="string">&quot;  j=&quot;</font><font class="text"> &lt;&lt; it-&gt;col()
               &lt;&lt; </font><font class="string">&quot;  val=&quot;</font><font class="text"> &lt;&lt; </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">setw</font><font class="text">(15) &lt;&lt; it-&gt;item() &lt;&lt; </font><font class="string">&quot; )&quot;
</font><font class="text">               &lt;&lt; </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">endl</font><font class="text"> ;
         }
      }
      it-&gt;destroy() ; it = 0 ;
      os &lt;&lt; </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">setprecision</font><font class="text">(p) ;
      os.</font><font class="kw2">flags</font><font class="text">( original_flags ) ;
   }
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: is_a_prototype( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw1">return</font><font class="text">( IS_PROTO ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: readMMHeader( </font><font class="kw2">std</font><font class="text">::ifstream&amp; in,
                          </font><font class="kw1">bool</font><font class="text">&amp; array,
                          </font><font class="kw1">bool</font><font class="text">&amp; sym,
                          </font><font class="kw2">size_t</font><font class="text">&amp; n,
                          </font><font class="kw2">size_t</font><font class="text">&amp; m,
                          </font><font class="kw2">size_t</font><font class="text">&amp; nb ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_LABEL</font><font class="text">( </font><font class="string">&quot;LA_Matrix:: readMMHeader&quot;</font><font class="text"> ) ;
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw3">PEL_CHECK_PRE</font><font class="text">( in ) ;

   </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">string</font><font class="text"> error_mess ;

   </font><font class="kw1">if</font><font class="text">( !in )
   {
      error_mess = </font><font class="string">&quot;Reading matrix header : file not opened &quot;</font><font class="text"> ;
   }
   </font><font class="kw1">else
</font><font class="text">   {
      </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">string</font><font class="text"> label, storage, content, type, kind, str ;
      in &gt;&gt; label &gt;&gt; content &gt;&gt; storage &gt;&gt; type &gt;&gt; kind ;
      getline( in, str ) ;

      </font><font class="kw1">if</font><font class="text">( ( label != </font><font class="string">&quot;%%MatrixMarket&quot;</font><font class="text"> )
          || ( content != </font><font class="string">&quot;matrix&quot;</font><font class="text"> )
          || ( type != </font><font class="string">&quot;real&quot;</font><font class="text"> )
          || ( !( storage == </font><font class="string">&quot;coordinate&quot;</font><font class="text"> || storage == </font><font class="string">&quot;array&quot;</font><font class="text"> ) )
          || ( !( kind == </font><font class="string">&quot;general&quot;</font><font class="text"> || kind == </font><font class="string">&quot;symmetric&quot;</font><font class="text"> ) ) )
      {
         error_mess = </font><font class="string">&quot;Reading matrix header : &quot;</font><font class="text"> ;

         </font><font class="kw1">if</font><font class="text">( label != </font><font class="string">&quot;%%MatrixMarket&quot;</font><font class="text"> )
         {
            error_mess += </font><font class="string">&quot; Bad label : &quot;</font><font class="text"> + label ;
         }
         </font><font class="kw1">if</font><font class="text">( content != </font><font class="string">&quot;matrix&quot;</font><font class="text"> )
         {
            error_mess += </font><font class="string">&quot; Bad content : &quot;</font><font class="text"> + content ;
         }
         </font><font class="kw1">if</font><font class="text">( type != </font><font class="string">&quot;real&quot;</font><font class="text"> )
         {
            error_mess += </font><font class="string">&quot; Bad type : &quot;</font><font class="text"> + type ;
         }
         </font><font class="kw1">if</font><font class="text">( !( storage == </font><font class="string">&quot;coordinate&quot;</font><font class="text"> || storage == </font><font class="string">&quot;array&quot;</font><font class="text"> ) )
         {
            error_mess += </font><font class="string">&quot; Bad storage : &quot;</font><font class="text"> + storage ;
         }
         </font><font class="kw1">if</font><font class="text">( !( kind == </font><font class="string">&quot;general&quot;</font><font class="text"> || kind == </font><font class="string">&quot;symmetric&quot;</font><font class="text"> ) )
         {
            error_mess += </font><font class="string">&quot; Bad matrix kind : &quot;</font><font class="text"> + kind ;
         }
      }
      </font><font class="kw1">else
</font><font class="text">      {
         sym = ( kind == </font><font class="string">&quot;symmetric&quot;</font><font class="text"> ) ;
         array = ( storage == </font><font class="string">&quot;array&quot;</font><font class="text"> ) ;
         </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">string</font><font class="text"> ss ;
         </font><font class="kw2">std</font><font class="text">::streampos pos = in.tellg() ;

         </font><font class="kw1">while</font><font class="text">( !in.eof() )
         {
            pos = in.tellg() ;
            getline( in, ss ) ;

            </font><font class="kw1">if</font><font class="text">( ss[0] != </font><font class="string">'%'</font><font class="text"> )
            {
               </font><font class="kw1">break</font><font class="text"> ;
            }
         }
         in.seekg( pos ) ;
         </font><font class="kw1">if</font><font class="text">( storage == </font><font class="string">&quot;coordinate&quot;</font><font class="text"> )
         {
            in &gt;&gt; n &gt;&gt; m &gt;&gt; nb ;
         }
         </font><font class="kw1">else
</font><font class="text">         {
            in &gt;&gt; n &gt;&gt; m ;
            nb = n*m ;
         }
      }
   }
   </font><font class="kw1">if</font><font class="text">( !error_mess.empty() )
   {
      </font><font class="kw3">PEL_Error</font><font class="text">::object()-&gt;raise_plain( error_mess ) ;
   }

   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: invariant( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">PEL_Object</font><font class="text">::invariant() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: create_matrix_PRE( </font><font class="kw3">PEL_Object</font><font class="text">* a_owner ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: create_matrix_POST(
                          </font><font class="kw3">LA_Matrix</font><font class="text">* result, </font><font class="kw3">PEL_Object</font><font class="text">* a_owner ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result != 0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;owner() == a_owner ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;name()==name() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;nb_rows() == nb_rows() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;nb_cols() == nb_cols() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;implementation() == implementation() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;name() == name() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;is_resizable() == is_resizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( result-&gt;is_desynchronizable(),
                        result-&gt;state() == </font><font class="kw3">LA</font><font class="text">::NotSync_undef ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;row_distribution()-&gt;is_compatible(
                                             row_distribution() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;col_distribution()-&gt;is_compatible(
                                             col_distribution() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( result-&gt;is_desynchronizable(),
                        !result-&gt;is_synchronized() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;distribution_strategy() == distribution_strategy() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: create_vector_PRE( </font><font class="kw3">PEL_Object</font><font class="text">* a_owner ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: create_vector_POST( </font><font class="kw3">LA_Vector</font><font class="text"> </font><font class="kw1">const</font><font class="text">* result, </font><font class="kw3">PEL_Object</font><font class="text">* a_owner ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result != 0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;owner() == a_owner ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;nb_rows() == nb_rows() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;implementation() == implementation() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;is_resizable() == is_resizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;is_desynchronizable() == is_desynchronizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;state() == </font><font class="kw3">LA</font><font class="text">::Sync ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">(
      result-&gt;row_distribution()-&gt;is_compatible( row_distribution() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;is_synchronized() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;distribution_strategy() == distribution_strategy() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: re_initialize_PRE(
                  </font><font class="kw2">size_t</font><font class="text"> a_nb_rows, </font><font class="kw2">size_t</font><font class="text"> a_nb_cols,
                  </font><font class="kw2">size_t</font><font class="text"> a_nb_local_rows, </font><font class="kw2">size_t</font><font class="text"> a_nb_local_cols ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( is_resizable() ) ;

   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( distribution_strategy() != </font><font class="kw3">LA</font><font class="text">::FromLocalSize,
                        a_nb_rows != </font><font class="kw3">PEL</font><font class="text">::bad_index() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( distribution_strategy() != </font><font class="kw3">LA</font><font class="text">::FromLocalSize,
                        a_nb_cols != </font><font class="kw3">PEL</font><font class="text">::bad_index() ) ) ;
   
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( distribution_strategy() == </font><font class="kw3">LA</font><font class="text">::FromLocalSize,
                        a_nb_local_rows != </font><font class="kw3">PEL</font><font class="text">::bad_index() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( distribution_strategy() == </font><font class="kw3">LA</font><font class="text">::FromLocalSize,
                        a_nb_local_cols != </font><font class="kw3">PEL</font><font class="text">::bad_index() ) ) ;
   
   </font><font class="kw3">PEL_ASSERT</font><font class="text">(
     </font><font class="kw3">IMPLIES</font><font class="text">( distribution_strategy() == </font><font class="kw3">LA</font><font class="text">::FromGlobalSize,
        </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;same_value_everywhere( (</font><font class="kw1">int</font><font class="text">) a_nb_rows ) ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">(
     </font><font class="kw3">IMPLIES</font><font class="text">( distribution_strategy() == </font><font class="kw3">LA</font><font class="text">::FromGlobalSize,
        </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;same_value_everywhere( (</font><font class="kw1">int</font><font class="text">) a_nb_cols ) ) ) ;

   </font><font class="kw3">PEL_ASSERT</font><font class="text">(
     </font><font class="kw3">IMPLIES</font><font class="text">( is_symmetric() &amp;&amp; distribution_strategy() != </font><font class="kw3">LA</font><font class="text">::FromLocalSize ,
              a_nb_rows == a_nb_cols ) ) ;

   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: re_initialize_POST( </font><font class="kw2">size_t</font><font class="text"> a_nb_rows, </font><font class="kw2">size_t</font><font class="text"> a_nb_cols,
                                </font><font class="kw2">size_t</font><font class="text"> a_nb_local_rows, </font><font class="kw2">size_t</font><font class="text"> a_nb_local_cols ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( distribution_strategy() != </font><font class="kw3">LA</font><font class="text">::FromLocalSize,
                        nb_rows() == a_nb_rows ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( distribution_strategy() != </font><font class="kw3">LA</font><font class="text">::FromLocalSize,
                        nb_cols() == a_nb_cols ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( distribution_strategy() == </font><font class="kw3">LA</font><font class="text">::FromLocalSize,
                        nb_local_rows() ==  a_nb_local_rows ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( distribution_strategy() == </font><font class="kw3">LA</font><font class="text">::FromLocalSize,
                        nb_local_cols() ==  a_nb_local_cols ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( is_desynchronizable(),
                        state() == </font><font class="kw3">LA</font><font class="text">::NotSync_undef ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( is_desynchronizable(), !is_synchronized() ) ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: implementation_POST( </font><font class="kw3">LA_Implementation</font><font class="text"> </font><font class="kw1">const</font><font class="text">* result ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result != 0 ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: is_symmetric_POST( </font><font class="kw1">bool</font><font class="text"> result ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( result, nb_rows() == nb_cols() ) ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: start_local_modifs_PRE( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( !only_local_modifs() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: start_local_modifs_POST( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( only_local_modifs() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: stop_local_modifs_PRE( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( only_local_modifs() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: stop_local_modifs_POST( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( !only_local_modifs() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: synchronize_PRE( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( is_desynchronizable(), !is_synchronized() ) ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: synchronize_POST( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( is_synchronized() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( state() == </font><font class="kw3">LA</font><font class="text">::Sync ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}


</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: row_distribution_PRE( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: row_distribution_POST(
                          </font><font class="kw3">PEL_DistributedPartition</font><font class="text"> </font><font class="kw1">const</font><font class="text">* result ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result != 0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;owner() == </font><font class="kw1">this</font><font class="text"> ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;partitioning().size()==
                               </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;nb_ranks() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;global_number()==nb_rows() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: col_distribution_PRE( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: col_distribution_POST(
                          </font><font class="kw3">PEL_DistributedPartition</font><font class="text"> </font><font class="kw1">const</font><font class="text">* result ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result != 0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;owner() == </font><font class="kw1">this</font><font class="text"> ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;partitioning().size()==
                               </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;nb_ranks() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;global_number()==nb_cols() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: create_stored_item_iterator_PRE( </font><font class="kw3">PEL_Object</font><font class="text">* a_owner ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( is_synchronized() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: create_stored_item_iterator_POST(
                  </font><font class="kw3">PEL_Object</font><font class="text">* a_owner, </font><font class="kw3">LA_MatrixIterator</font><font class="text">* result ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result != 0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;owner() == a_owner ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;is_valid() == </font><font class="kw1">false</font><font class="text"> ) ;

   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: create_local_matrix_PRE( </font><font class="kw3">PEL_Object</font><font class="text">* a_owner ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( is_synchronized() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: create_local_matrix_POST( </font><font class="kw3">LA_SeqMatrix</font><font class="text"> </font><font class="kw1">const</font><font class="text">* result,
                                      </font><font class="kw3">PEL_Object</font><font class="text">* a_owner ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result != 0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;owner() == a_owner ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;nb_rows() == nb_rows() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;nb_cols() == nb_cols() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;is_synchronized() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: nb_stored_items_PRE( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( is_synchronized() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: extract_diag_PRE( </font><font class="kw3">LA_Vector</font><font class="text"> </font><font class="kw1">const</font><font class="text">* diag ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( is_synchronized() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( nb_rows() == nb_cols() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( diag != 0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( diag-&gt;nb_rows() == nb_cols() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( diag-&gt;implementation() == implementation() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">(
      diag-&gt;row_distribution()-&gt;is_compatible( row_distribution() ) ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: extract_diag_POST( </font><font class="kw3">LA_Vector</font><font class="text"> </font><font class="kw1">const</font><font class="text">* diag ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( diag-&gt;is_synchronized() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: set_item_PRE( </font><font class="kw2">size_t</font><font class="text"> i, </font><font class="kw2">size_t</font><font class="text"> j ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( i &lt; nb_rows() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( j &lt; nb_cols() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( only_local_modifs(),
                        i &gt;= row_distribution()-&gt;first_local_index() &amp;&amp;
                        i &lt; row_distribution()-&gt;local_index_limit() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( state() != </font><font class="kw3">LA</font><font class="text">::NotSync_add ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( is_symmetric(), i&lt;=j ) ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: set_item_POST( </font><font class="kw2">size_t</font><font class="text"> i, </font><font class="kw2">size_t</font><font class="text"> j,
                           </font><font class="kw3">LA</font><font class="text">::SyncState old_state ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">(
   </font><font class="kw3">IMPLIES</font><font class="text">( is_desynchronizable() &amp;&amp; !only_local_modifs(),
            state() == </font><font class="kw3">LA</font><font class="text">::NotSync_set ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">(
   </font><font class="kw3">IMPLIES</font><font class="text">( !is_desynchronizable() || only_local_modifs(),
            state() == old_state ) ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: add_to_item_PRE( </font><font class="kw2">size_t</font><font class="text"> i, </font><font class="kw2">size_t</font><font class="text"> j ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( i &lt; nb_rows() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( j &lt; nb_cols() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( only_local_modifs(),
                        i &gt;= row_distribution()-&gt;first_local_index() &amp;&amp;
                        i &lt; row_distribution()-&gt;local_index_limit() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( state() != </font><font class="kw3">LA</font><font class="text">::NotSync_set ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( is_symmetric(), i&lt;=j ) ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: add_to_item_POST( </font><font class="kw2">size_t</font><font class="text"> i, </font><font class="kw2">size_t</font><font class="text"> j,
                              </font><font class="kw3">LA</font><font class="text">::SyncState old_state ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">(
      </font><font class="kw3">IMPLIES</font><font class="text">( is_desynchronizable() &amp;&amp; !only_local_modifs(),
               state() == </font><font class="kw3">LA</font><font class="text">::NotSync_add ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">(
   </font><font class="kw3">IMPLIES</font><font class="text">( !is_desynchronizable() || only_local_modifs(),
            state() == old_state ) ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: nullify_PRE( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: nullify_POST( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="comment">//??? Matrix is not synchronized because of PETSc:
</font><font class="text">   </font><font class="comment">//???   synchronization freezes matrix pattern and avoids assembling
</font><font class="text">   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( is_desynchronizable(),
                        state() == </font><font class="kw3">LA</font><font class="text">::NotSync_undef ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( is_desynchronizable(),
                        !is_synchronized() ) ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: scale_PRE( </font><font class="kw1">double</font><font class="text"> alpha ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( is_synchronized() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">(
      </font><font class="kw3">IMPLIES</font><font class="text">( is_desynchronizable(),
               </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;same_value_everywhere( alpha ) ) ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: scale_POST( </font><font class="kw1">double</font><font class="text"> alpha ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( is_synchronized() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: multiply_vec_then_add_PRE( </font><font class="kw3">LA_Vector</font><font class="text"> </font><font class="kw1">const</font><font class="text">* x,
                                       </font><font class="kw3">LA_Vector</font><font class="text">* y,
                                       </font><font class="kw1">double</font><font class="text"> alpha,
                                       </font><font class="kw1">double</font><font class="text"> beta ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( is_synchronized() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( x != 0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( x-&gt;nb_rows() == nb_cols() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( x-&gt;implementation() == implementation() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( x-&gt;is_synchronized() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( x-&gt;row_distribution()-&gt;is_compatible( col_distribution() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( y != 0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( y-&gt;nb_rows() == nb_rows() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( y-&gt;implementation() == implementation() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( y-&gt;is_synchronized() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( y-&gt;row_distribution()-&gt;is_compatible( row_distribution() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( x != y ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">(
      </font><font class="kw3">IMPLIES</font><font class="text">( is_desynchronizable(),
               </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;same_value_everywhere( alpha ) ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( alpha != 0. ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">(
      </font><font class="kw3">IMPLIES</font><font class="text">( is_desynchronizable(),
               </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;same_value_everywhere( beta ) ) ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: multiply_vec_then_add_POST( </font><font class="kw3">LA_Vector</font><font class="text">* y ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( y-&gt;is_synchronized() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: tr_multiply_vec_then_add_PRE( </font><font class="kw3">LA_Vector</font><font class="text"> </font><font class="kw1">const</font><font class="text">* x,
                                          </font><font class="kw3">LA_Vector</font><font class="text">* y,
                                          </font><font class="kw1">double</font><font class="text"> alpha,
                                          </font><font class="kw1">double</font><font class="text"> beta ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( is_synchronized() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( x != 0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( x-&gt;nb_rows() == nb_rows() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( x-&gt;implementation() == implementation() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( x-&gt;is_synchronized() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( x-&gt;row_distribution()-&gt;is_compatible( row_distribution() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( y != 0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( y-&gt;nb_rows() == nb_cols() ) ;;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( y-&gt;implementation() == implementation() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( y-&gt;is_synchronized() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( y-&gt;row_distribution()-&gt;is_compatible( col_distribution() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( x != y ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">(
      </font><font class="kw3">IMPLIES</font><font class="text">( is_desynchronizable(),
               </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;same_value_everywhere( alpha ) ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( alpha != 0. ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">(
      </font><font class="kw3">IMPLIES</font><font class="text">( is_desynchronizable(),
               </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;same_value_everywhere( beta ) ) ) ;

   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: tr_multiply_vec_then_add_POST( </font><font class="kw3">LA_Vector</font><font class="text">* y ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( y-&gt;is_synchronized() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: scale_as_diag_mat_mat_PRE( </font><font class="kw3">LA_Vector</font><font class="text"> </font><font class="kw1">const</font><font class="text">* lvec ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( is_synchronized() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( !is_symmetric() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( lvec != 0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( lvec-&gt;nb_rows() == nb_rows() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( lvec-&gt;implementation() == implementation() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( lvec-&gt;is_synchronized() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( lvec-&gt;row_distribution()-&gt;is_compatible( row_distribution() ) ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: scale_as_diag_mat_mat_POST( </font><font class="kw1">void</font><font class="text">) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( is_synchronized() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: scale_as_mat_diag_mat_PRE( </font><font class="kw3">LA_Vector</font><font class="text"> </font><font class="kw1">const</font><font class="text">* rvec ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( is_synchronized() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( !is_symmetric() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( rvec != 0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( rvec-&gt;nb_rows() == nb_cols() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( rvec-&gt;implementation() == implementation() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( rvec-&gt;is_synchronized() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( rvec-&gt;row_distribution()-&gt;is_compatible( col_distribution() ) ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: scale_as_mat_diag_mat_POST( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( is_synchronized() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: add_to_diag_PRE( </font><font class="kw3">LA_Vector</font><font class="text"> </font><font class="kw1">const</font><font class="text">* vec ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( state() != </font><font class="kw3">LA</font><font class="text">::NotSync_set ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( nb_cols() == nb_rows() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( vec != 0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( vec-&gt;nb_rows() == nb_rows() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( vec-&gt;implementation() == implementation() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( vec-&gt;is_synchronized() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( vec-&gt;row_distribution()-&gt;is_compatible( row_distribution() ) ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: add_to_diag_POST( </font><font class="kw3">LA</font><font class="text">::SyncState old_state ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( state() == old_state ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: set_PRE( </font><font class="kw3">LA_Matrix</font><font class="text"> </font><font class="kw1">const</font><font class="text">* A, </font><font class="kw1">bool</font><font class="text"> same_pattern ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A != 0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;nb_rows()==nb_rows() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;nb_cols()==nb_cols() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;row_distribution()-&gt;is_compatible( row_distribution() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;col_distribution()-&gt;is_compatible( col_distribution() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;is_synchronized() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;implementation()==implementation() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( is_symmetric() , A-&gt;is_symmetric() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( !is_a_prototype() ) ;

   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: set_POST( </font><font class="kw3">LA_Matrix</font><font class="text"> </font><font class="kw1">const</font><font class="text">* A ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( is_desynchronizable(), state() == </font><font class="kw3">LA</font><font class="text">::NotSync_undef ) ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: add_Mat_PRE( </font><font class="kw3">LA_Matrix</font><font class="text"> </font><font class="kw1">const</font><font class="text">* A, </font><font class="kw1">double</font><font class="text"> alpha,
                         </font><font class="kw1">bool</font><font class="text"> same_pattern ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( state() != </font><font class="kw3">LA</font><font class="text">::NotSync_set ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A != 0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A != </font><font class="kw1">this</font><font class="text"> ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;nb_rows() == nb_rows() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;nb_cols() == nb_cols() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;implementation() == implementation() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;is_synchronized() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;row_distribution()-&gt;is_compatible( row_distribution() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;col_distribution()-&gt;is_compatible( col_distribution() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">(
       </font><font class="kw3">IMPLIES</font><font class="text">( is_desynchronizable(),
                </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;same_value_everywhere( alpha ) ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( alpha != 0. ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: add_Mat_POST( </font><font class="kw3">LA</font><font class="text">::SyncState old_state ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( state() == old_state ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: add_tMat_PRE( </font><font class="kw3">LA_Matrix</font><font class="text"> </font><font class="kw1">const</font><font class="text">* A,
                          </font><font class="kw1">double</font><font class="text"> alpha ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( state() != </font><font class="kw3">LA</font><font class="text">::NotSync_set ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A != 0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A != </font><font class="kw1">this</font><font class="text"> ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;nb_rows() == nb_cols() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;nb_cols() == nb_rows() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;implementation() == implementation() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;is_synchronized() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;row_distribution()-&gt;is_compatible( col_distribution() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;col_distribution()-&gt;is_compatible( row_distribution() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">(
       </font><font class="kw3">IMPLIES</font><font class="text">( is_desynchronizable(),
                </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;same_value_everywhere( alpha ) ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( alpha != 0. ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: add_tMat_POST( </font><font class="kw3">LA</font><font class="text">::SyncState old_state ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( state() == old_state ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: add_Mat_Mat_PRE( </font><font class="kw3">LA_Matrix</font><font class="text"> </font><font class="kw1">const</font><font class="text">* A,
                             </font><font class="kw3">LA_Matrix</font><font class="text"> </font><font class="kw1">const</font><font class="text">* B,
                             </font><font class="kw1">double</font><font class="text"> alpha ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( state() != </font><font class="kw3">LA</font><font class="text">::NotSync_set ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A != 0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A != </font><font class="kw1">this</font><font class="text"> ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;nb_rows() == nb_rows() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;implementation() == implementation() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;is_synchronized() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( A-&gt;row_distribution()-&gt;is_compatible( row_distribution() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( B != 0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( B != </font><font class="kw1">this</font><font class="text"> ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( B-&gt;nb_rows() == A-&gt;nb_cols() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( B-&gt;nb_cols() == nb_cols() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( B-&gt;implementation() == implementation() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( B-&gt;is_synchronized() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( B-&gt;row_distribution()-&gt;is_compatible( A-&gt;col_distribution() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( B-&gt;col_distribution()-&gt;is_compatible( col_distribution() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">(
      </font><font class="kw3">IMPLIES</font><font class="text">( is_desynchronizable(),
               </font><font class="kw3">PEL_Exec</font><font class="text">::communicator()-&gt;same_value_everywhere( alpha ) ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( alpha != 0. ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( !is_symmetric() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: add_Mat_Mat_POST( </font><font class="kw3">LA</font><font class="text">::SyncState old_state ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( state() == old_state ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: readMM_PRE( </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">string</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; file ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( !file.empty() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: readMM_POST( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( is_synchronized() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: writeMM_PRE( </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">string</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; file ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   PEL_CHECK_COLLECTIVE( is_desynchronizable() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( !file.empty() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( is_synchronized() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: writeMM_POST( </font><font class="kw1">void</font><font class="text"> ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: print_items_PRE( </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">ostream</font><font class="text">&amp; os, </font><font class="kw2">size_t</font><font class="text"> indent_width ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( os ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( is_synchronized() ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: create_replica_PRE( </font><font class="kw3">PEL_Object</font><font class="text">* a_owner,
                                </font><font class="kw3">PEL_ModuleExplorer</font><font class="text"> </font><font class="kw1">const</font><font class="text">* exp ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
</font><font class="comment">//   PEL_CHECK_COLLECTIVE( is_distributed() ) ; les prototypes ne le sont pas
</font><font class="text">   </font><font class="kw3">PEL_ASSERT</font><font class="text">( is_a_prototype() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( exp != 0 ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw1">bool
</font><font class="kw3">LA_Matrix</font><font class="text">:: create_replica_POST( </font><font class="kw3">LA_Matrix</font><font class="text"> </font><font class="kw1">const</font><font class="text">* result,
                                 </font><font class="kw3">PEL_Object</font><font class="text">* a_owner,
                                 </font><font class="kw3">PEL_ModuleExplorer</font><font class="text"> </font><font class="kw1">const</font><font class="text">* exp ) </font><font class="kw1">const
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result != 0 ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;owner() == a_owner ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;name() == name() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( !result-&gt;is_a_prototype() ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( </font><font class="kw3">IMPLIES</font><font class="text">( result-&gt;is_desynchronizable(),
                        !result-&gt;is_synchronized() ) ) ;
   </font><font class="kw3">PEL_ASSERT</font><font class="text">( result-&gt;distribution_strategy() != </font><font class="kw3">LA</font><font class="text">::InvalidDistribution ) ;
   </font><font class="kw1">return</font><font class="text">( </font><font class="kw1">true</font><font class="text"> ) ;
}

</font><font class="comment">//----------------------------------------------------------------------
</font><font class="kw3">PEL_ObjectRegister</font><font class="text">*
</font><font class="kw3">LA_Matrix</font><font class="text">:: plugins_map( </font><font class="kw1">void</font><font class="text"> )
</font><font class="comment">//----------------------------------------------------------------------
</font><font class="text">{
   </font><font class="kw1">static</font><font class="text"> </font><font class="kw3">PEL_ObjectRegister</font><font class="text">* result =
      </font><font class="kw3">PEL_ObjectRegister</font><font class="text">::create( </font><font class="kw3">PEL_Root</font><font class="text">::object(),
                                  </font><font class="string">&quot;LA_Matrix descendant&quot;</font><font class="text"> ) ;
   </font><font class="kw1">return</font><font class="text">( result ) ;
}

</font>
</pre>
</body>
</html>
