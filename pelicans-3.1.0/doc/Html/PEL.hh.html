<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">
<html>
<head>
  <title>PEL.hh</title>
  <link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
</head>
<script>
  function asd()
  {
    parent.document.title="PEL.hh_PELICANS 17_03_2010 ";
  }
</script> 

<body onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<div id=navbar>
  <a name="navbar_top_firstrow"><!-- --></a>
  <div id=navbarapp>PELICANS 17_03_2010</div>
  <div id=navbarmenu>
    <a href="PELpack-tree.html"><span>Tree</span></a>
    <a href="PEL.html"><span>Class</span></a>
    <span class=selected>Header</span>
    <a href="PEL.cc.html"><span>Implementation</span></a>
    <a href="PEL.icc.html"><span>Inlined</span></a>
    <div id=navbarsub>
      <a href="index.html" target="_top">FRAMES :</a>
      <a href="PELpack-tree.html" target="_top">: NO FRAMES</a>
    </div>
  </div>
</div>
<!-- ========== END OF NAVBAR ========== -->

<pre>
<font class="comment">/*
 *  Copyright 1995-2010 by IRSN
 *
 *  This software is an application framework, with a set of integrated  
 *  reusable components, whose purpose is to simplify the task of developing 
 *  softwares of numerical mathematics and scientific computing.
 * 
 *  This software is governed by the CeCILL-C license under French law and 
 *  abiding by the rules of distribution of free software. You can use, modify 
 *  and/or redistribute the software under the terms of the CeCILL-C license  
 *  as circulated by CEA, CNRS and INRIA at the following URL 
 *  &quot;http://www.cecill.info&quot;. 
 *
 *  As a counterpart to the access to the source code and rights to copy,  
 *  modify and redistribute granted by the license, users are provided only 
 *  with a limited warranty and the software's author, the holder of the  
 *  economic rights, and the successive licensors have only limited liability. 
 *
 *  In this respect, the user's attention is drawn to the risks associated  
 *  with loading, using, modifying and/or developing or reproducing the  
 *  software by the user in light of its specific status of free software,
 *  that may mean that it is complicated to manipulate, and that also  
 *  therefore means that it is reserved for developers and experienced 
 *  professionals having in-depth computer knowledge. Users are therefore 
 *  encouraged to load and test the software's suitability as regards their 
 *  requirements in conditions enabling the security of their systems and/or 
 *  data to be ensured and, more generally, to use and operate it in the same 
 *  conditions as regards security. 
 *
 *  The fact that you are presently reading this means that you have had 
 *  knowledge of the CeCILL-C license and that you accept its terms.
 */
</font><font class="text">
</font><font class="kw2">#ifndef</font><font class="text"> PEL_HH
</font><font class="kw2">#define</font><font class="text"> PEL_HH

</font><font class="kw2">#include</font><font class="text"> &lt;cstddef&gt;
</font><font class="kw2">#include</font><font class="text"> &lt;iosfwd&gt;
</font><font class="kw2">#include</font><font class="text"> &lt;</font><font class="kw2">string</font><font class="text">&gt;

</font><font class="kw2">#include</font><font class="text"> &lt;</font><font class="kw3">PEL_export</font><font class="text">.hh&gt;

</font><font class="kw2">#ifdef</font><font class="text"> max
#undef max
</font><font class="kw2">#endif
#ifdef</font><font class="text"> min
#undef min
</font><font class="kw2">#endif
</font><font class="text">
</font><font class="comment">/*
PUBLISHED
*/
</font><font class="text">
</font><font class="kw1">class</font><font class="text"> PEL_EXPORT PEL
{
   </font><font class="kw1">public</font><font class="text">: </font><font class="comment">//-----------------------------------------------------------------
</font><font class="text">
   </font><font class="comment">//-- Usefull numeric constants
</font><font class="text">      
      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> pi( </font><font class="kw1">void</font><font class="text"> ) ;

      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> e( </font><font class="kw1">void</font><font class="text"> ) ;

      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> euler( </font><font class="kw1">void</font><font class="text"> ) ;
      
      </font><font class="comment">// difference between 1 and the least value greater than 1 that is
</font><font class="text">      </font><font class="comment">// representable
</font><font class="text">      </font><font class="comment">// IMPLEMENTATION : std::numeric_limits&lt;double&gt;::epsilon()
</font><font class="text">      </font><font class="comment">//    (eg on some machines : 2.22044...e-16)
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> epsilon_double( </font><font class="kw1">void</font><font class="text"> ) ;
      
      </font><font class="comment">// minimal representable no zero double value
</font><font class="text">      </font><font class="comment">// IMPLEMENTATION : std::numeric_limits&lt;double&gt;::min()
</font><font class="text">      </font><font class="comment">//    (eg on some machines : 2.22507...e-308)
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> min_double( </font><font class="kw1">void</font><font class="text"> ) ;

      </font><font class="comment">// maximum finite double value
</font><font class="text">      </font><font class="comment">// IMPLEMENTATION : std::numeric_limits&lt;double&gt;::max()
</font><font class="text">      </font><font class="comment">//    (eg on some machines : 1.79769...e+308)
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> max_double( </font><font class="kw1">void</font><font class="text"> ) ;

      </font><font class="comment">// maximum finite int value
</font><font class="text">      </font><font class="comment">// IMPLEMENTATION : std::numeric_limits&lt;int&gt;::max()
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">int</font><font class="text"> max_int( </font><font class="kw1">void</font><font class="text"> ) ;
      
      </font><font class="comment">// IMPLEMENTATION : static_cast&lt;size_t&gt;(~0)
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw2">size_t</font><font class="text"> bad_index( </font><font class="kw1">void</font><font class="text"> ) ;

      </font><font class="comment">// IMPLEMENTATION : std::numeric_limits&lt;int&gt;::max()
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">int</font><font class="text"> bad_int( </font><font class="kw1">void</font><font class="text"> ) ;

      </font><font class="comment">// IMPLEMENTATION : std::numeric_limits&lt;double&gt;::max()
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> bad_double( </font><font class="kw1">void</font><font class="text"> ) ;

   </font><font class="comment">//-- Power functions
</font><font class="text">
      </font><font class="comment">// `x'*`x'
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> sqr( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="comment">// IMPLEMENTATION : std::sqrt( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> sqrt( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="comment">// `x' power `exp'
</font><font class="text">      </font><font class="comment">// IMPLEMENTATION : std::pow( `x', `exp' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> pow( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x, </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> exp ) ;

      </font><font class="comment">// IMPLEMENTATION : std::exp( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> exp( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="comment">// IMPLEMENTATION : std::log( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> log( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="comment">// IMPLEMENTATION : std::log10( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> log10( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;
      
   </font><font class="comment">//-- Trigonometric functions (in radians)
</font><font class="text">
      </font><font class="comment">// IMPLEMENTATION : std::sin( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> sin( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="comment">// IMPLEMENTATION : std::cos( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> cos( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="comment">// IMPLEMENTATION : std::tan( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> tan( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="comment">// IMPLEMENTATION : std::asin( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> asin( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="comment">// IMPLEMENTATION : std::acos( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> acos( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="comment">// IMPLEMENTATION : std::atan( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> atan( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="comment">// angle in radian of bidimensional vector (`x',`y')
</font><font class="text">      </font><font class="comment">// IMPLEMENTATION : std::atan2( `x', `y' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> atan2( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x, </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> y ) ;

   </font><font class="comment">//-- Hyperbolic functions (in radians)
</font><font class="text">
      </font><font class="comment">// IMPLEMENTATION : std::sinh( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> sinh( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="comment">// IMPLEMENTATION : std::cosh( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> cosh( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="comment">// IMPLEMENTATION : std::tanh( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> tanh( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

   </font><font class="comment">//-- Comparison functions
</font><font class="text">      
      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">int</font><font class="text">    max( </font><font class="kw1">int</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; x, </font><font class="kw1">int</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; y ) ;
      </font><font class="kw1">static</font><font class="text"> </font><font class="kw2">size_t</font><font class="text"> max( </font><font class="kw2">size_t</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; x, </font><font class="kw2">size_t</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; y ) ;
      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> max( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; x, </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; y ) ;
      
      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">int</font><font class="text">    min( </font><font class="kw1">int</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; x, </font><font class="kw1">int</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; y ) ;
      </font><font class="kw1">static</font><font class="text"> </font><font class="kw2">size_t</font><font class="text"> min( </font><font class="kw2">size_t</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; x, </font><font class="kw2">size_t</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; y ) ;
      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> min( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; x, </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; y ) ;

      </font><font class="comment">/*
      Are `x' and `y' close enough ? 
         (1) if( x == y ) return true 
             (in that case `a_dbl_min' and `a_dbl_max' can be exactly zero)
         (2) if |`x'|&lt;`a_dbl_min' and |`y'|&lt;`a_dbl_min' return true
         (3) if |`x'|&gt;=`a_dbl_min' and |`y'|&gt;=`a_dbl_min' :
                . return true if  1.0-`a_dbl_eps'&lt;`x'/`y'&lt; 1.0+`a_dbl_eps'
                  (overflow and underflow when evaluating `x'/`y' are handled)
                . return false otherwise
         (4) if |`x'|&lt;`a_dbl_min' and |`y'|&gt;=`a_dbl_min'
             return result given by (3) with `x' replaced by `a_dbl_min'
         (5) if |`y'|&lt;`a_dbl_min' and |`x'|&gt;=`a_dbl_min'
             return result given by (3) with `y' replaced by `a_dbl_min'
</font><font class="text">
</font><font class="comment">      stated differently :
</font><font class="text">
</font><font class="comment">         [1] `a_dbl_min' represents the lower bound under which `x' or `y'
             are undistinguishable from 0
</font><font class="text">
</font><font class="comment">         [2] if both `x' and `y' are undistinguishable from 0, they
             are close enough
</font><font class="text">
</font><font class="comment">         [3] if both `x' and `y' are distinguishable from 0, they are close 
             enough provided that |`x'/`y'-1.0| is lower than `a_dbl_eps'
</font><font class="text">
</font><font class="comment">         [4] if one of `x' or `y' is undistinguishable from 0, the other is 
             compared to `a_dbl_min' as in [3]
      */
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">bool</font><font class="text"> double_equality( double </font><font class="kw1">const</font><font class="text"> x, </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> y,
                                   </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> a_dbl_eps, 
                                   </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> a_dbl_min ) ;

      </font><font class="comment">/*
      Are `x' and `y' close enough, according to
         `::double_equality'( `x', `y', `a_dbl_eps', `a_dbl_min' ) ?
      if true, `status' is equal to 0.0
      if false because of an unsuccessful comparision of a relative
         error to `a_dbl_eps', `status' is equal to that relative error ;
         if false for another reason, `status' is equal to -1.0
      */
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">bool</font><font class="text"> double_equality( double </font><font class="kw1">const</font><font class="text"> x, </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> y,
                                   </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> a_dbl_eps, 
                                   </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> a_dbl_min,
                                   </font><font class="kw1">double</font><font class="text">&amp; status ) ;

   </font><font class="comment">//-- Rounding functions
</font><font class="text">      
      </font><font class="comment">// smallest integer not less than `x'
</font><font class="text">      </font><font class="comment">// IMPLEMENTATION : std::ceil( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> ceil( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="comment">// largest integer not greater than `x'
</font><font class="text">      </font><font class="comment">// IMPLEMENTATION : std::floor( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> floor( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> abs( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; x ) ;
      </font><font class="kw1">static</font><font class="text"> </font><font class="kw2">size_t</font><font class="text"> abs( </font><font class="kw1">int</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; x ) ;

   </font><font class="comment">//-- Extended mathematic functions (not supported on all system)
</font><font class="text">
      </font><font class="comment">// IMPLEMENTATION : ::asinh( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> asinh( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="comment">// IMPLEMENTATION : ::acosh( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> acosh( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="comment">// IMPLEMENTATION : ::atanh( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> atanh( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="comment">// First order Bessel function : n=0
</font><font class="text">      </font><font class="comment">// IMPLEMENTATION : ::j0( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> j0( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;
      
      </font><font class="comment">// First order Bessel function : n=1
</font><font class="text">      </font><font class="comment">// IMPLEMENTATION : ::j1( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> j1( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;
      
      </font><font class="comment">// First order Bessel function
</font><font class="text">      </font><font class="comment">// IMPLEMENTATION : ::jn( `n', `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> jn( </font><font class="kw1">int</font><font class="text"> </font><font class="kw1">const</font><font class="text"> n, </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="comment">// Second order Bessel function : n=0
</font><font class="text">      </font><font class="comment">// IMPLEMENTATION : ::y0( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> y0( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;
      
      </font><font class="comment">// Second order Bessel function : n=1
</font><font class="text">      </font><font class="comment">// IMPLEMENTATION : ::y1( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> y1( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;
      
      </font><font class="comment">// Second order Bessel function
</font><font class="text">      </font><font class="comment">// IMPLEMENTATION : ::yn( `n', `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> yn( </font><font class="kw1">int</font><font class="text"> </font><font class="kw1">const</font><font class="text"> n, </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="comment">// gamma function, ie sum(0,+oo){ t^(x-1) . exp( -t ) }
</font><font class="text">      </font><font class="comment">// IMPLEMENTATION : compute from ::lgamma( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> gamma( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;
      
      </font><font class="comment">// logarithm of gamma function absolute value
</font><font class="text">      </font><font class="comment">// IMPLEMENTATION : ::lgamma( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> lgamma( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="comment">// IMPLEMENTATION : ::erf( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> erf( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

      </font><font class="comment">// IMPLEMENTATION : ::erfc( `x' )
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> erfc( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x ) ;

   </font><font class="comment">//-- Special Functions (from Numerical Recipies)
</font><font class="text">
      </font><font class="comment">// incomplete gamma function, ie sum(t=0,x){ t^(a-1) . exp( -t ) }
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> incomplete_gamma( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> a, </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x,
                                      </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> epsilon_min=1.E-30,
                                      </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> error_bound=1.E-14,
                                      </font><font class="kw2">size_t</font><font class="text"> </font><font class="kw1">const</font><font class="text"> iteration_max=100 ) ;

      </font><font class="comment">// En(x), ie sum(t=1,+oo){ exp( -xt )/t^n }
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> En( </font><font class="kw2">size_t</font><font class="text"> </font><font class="kw1">const</font><font class="text"> n, </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x,
                        </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> epsilon_min=1.E-30,
                        </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> error_bound=1.E-7,
                        </font><font class="kw2">size_t</font><font class="text"> </font><font class="kw1">const</font><font class="text"> iteration_max=100 ) ;
      
      </font><font class="comment">// Ei(x), ie sum(t=-x,+oo){ exp( -t )/t }
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> Ei( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x,
                        </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> epsilon_min=1.E-30,
                        </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> error_bound=6.E-8,
                        </font><font class="kw2">size_t</font><font class="text"> </font><font class="kw1">const</font><font class="text"> iteration_max=100 ) ;
      
      </font><font class="comment">// random number between 0.0 and 1.0
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> random_double( </font><font class="kw1">void</font><font class="text"> ) ;
      
      </font><font class="comment">// random integer between 0 and max_int()
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">int</font><font class="text"> rand( </font><font class="kw1">void</font><font class="text"> ) ;
      
   </font><font class="comment">//-- String functions
</font><font class="text">
      </font><font class="comment">// Replace each occurence of `src' in `str' by `dest'.
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">void</font><font class="text"> replace( </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">string</font><font class="text">&amp; str,
                           </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">string</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; src,
                           </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">string</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; dest ) ;

      </font><font class="comment">// Remove first and last character of `str' if equal to `car'.
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">void</font><font class="text"> remove_enclosing_characters( </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">string</font><font class="text">&amp; str,
                                               </font><font class="kw1">char</font><font class="text"> </font><font class="kw1">const</font><font class="text"> car ) ;
      
   </font><font class="comment">//-- Input - Output
</font><font class="text">      
      </font><font class="comment">// Pelicans standard output stream.
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">ostream</font><font class="text">&amp; out( </font><font class="kw1">void</font><font class="text"> ) ;
      
      </font><font class="comment">// Pelicans standard error stream.
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">ostream</font><font class="text">&amp; err( </font><font class="kw1">void</font><font class="text"> ) ;
      
      </font><font class="comment">// Pelicans standard input stream.
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw2">std</font><font class="text">::istream&amp; in( </font><font class="kw1">void</font><font class="text"> ) ;

      </font><font class="comment">// Print `data' in `os' stream.
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">void</font><font class="text"> print_double( </font><font class="kw2">std</font><font class="text">::</font><font class="kw2">ostream</font><font class="text">&amp; os, </font><font class="kw1">double</font><font class="text"> data ) ;
      
   </font><font class="comment">//-- Hidden
</font><font class="text">
      </font><font class="comment">// legacy and obsolete function : should not be used
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">double</font><font class="text"> relative( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> v1, </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> v2 ) ;
      
      </font><font class="comment">// legacy and obsolete function : should not be used
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">bool</font><font class="text"> toler( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> val,
                         </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> eps = 1.E-14 ) ;

      </font><font class="comment">// legacy and obsolete function : should not be used
</font><font class="text">      </font><font class="comment">// (use double_equality instead)
</font><font class="text">      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">bool</font><font class="text"> equal( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> val1, </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> val2,
                         </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> eps = 1.E-14 ) ;

   </font><font class="kw1">protected</font><font class="text">: </font><font class="comment">//--------------------------------------------------------------
</font><font class="text">
   </font><font class="kw1">private</font><font class="text">: </font><font class="comment">//----------------------------------------------------------------
</font><font class="text">
      </font><font class="kw3">PEL</font><font class="text">( </font><font class="kw1">void</font><font class="text"> ) ;
     ~</font><font class="kw3">PEL</font><font class="text">( </font><font class="kw1">void</font><font class="text"> ) ;
      </font><font class="kw3">PEL</font><font class="text">( </font><font class="kw3">PEL</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; other ) ;
      </font><font class="kw3">PEL</font><font class="text">&amp; </font><font class="kw1">operator</font><font class="text">=( </font><font class="kw3">PEL</font><font class="text"> </font><font class="kw1">const</font><font class="text">&amp; other ) ;

   </font><font class="comment">//-- Internals
</font><font class="text">
      </font><font class="kw1">static</font><font class="text"> </font><font class="kw1">bool</font><font class="text"> ratio_close_to_one( </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> x, </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> y,
                                      </font><font class="kw1">double</font><font class="text"> </font><font class="kw1">const</font><font class="text"> a_dbl_eps,
                                      </font><font class="kw1">double</font><font class="text">&amp; status ) ;
      
} ;

</font><font class="kw2">#ifndef</font><font class="text"> OUTLINE
   </font><font class="kw2">#include</font><font class="text"> &lt;</font><font class="kw3">PEL</font><font class="text">.icc&gt;
</font><font class="kw2">#endif
</font><font class="text">
</font><font class="kw2">#endif
</font><font class="text">
</font>
</pre>
</body>
</html>
