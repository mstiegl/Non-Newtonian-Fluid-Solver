BATCH
ECHO 0 STAT PS

FRAME WHITE 21. 21.

FILE 'save.gene' FORM END

CYCL ALL
PHYS TIME TABL TTT
ANAL TTT
 n_cycles=(NUMBER TTT)
END-ANAL

CYCL 1
PHYS NVER TABLE NVER
CALL "build_meshing.tic"

ANAL
   TT = SR1
   UC = SR1
END-ANAL TT UC

(i_cycle=1)

LOOP

   CYCLE (i_cycle)

   PHYS TIME TABL TIME
   PHYS 0 UU TABL U

   ANAL TIME X Z NCON NVER U
      NVERT = NVER:1
      xa = 0.0
      za = 0.0
      dd = 1.E-4 
      ifound = 0 
      i = 0
      DO 'm' 1 (NUMBER NCON)/NVERT
         xc = 0.0
         zc = 0.0
         DO 'j' 1 NVERT
            i = i+1
            iv = NCON:i
            xc = xc + X:iv
            zc = zc + Z:iv
         ENDDO
         xc = xc/(FLOAT(NVERT))
         zc = zc/(FLOAT(NVERT))
         dpab = ABS((xc-xa)*(xc-xa)+(zc-za)*(zc-za))
         IFTHEN(dpab<dd)
            IFTHEN(ifound>5)
               PRINT "found two"
               EXIT
            ENDIF
            TT(0)<-TIME:1
            UC(0)<-U:m
            ifound=10
         ENDIF
      ENDDO
      IFTHEN(ifound<>10)
         PRINT "not found"
         PRINT ifound
         EXIT
      ENDIF
      SUPPRESS NVERT
   END-ANAL TT UC

   (i_cycle=i_cycle+1)
   IF (i_cycle>n_cycles) EXIT

ENDLOOP

LIST TABL TT 0
LIST TABL UC 0

COLOR RED CURV TT UC "computed"

CREA XANA
0.00000E+00 1.00000E-01 2.00000E-01 3.00000E-01 4.00000E-01 5.00000E-01 
6.00000E-01 7.00000E-01 8.00000E-01 9.00000E-01 1.00000E-00 1.10000E+00 
1.20000E+00 1.30000E+00 1.40000E+00 1.50000E+00 1.60000E+00 1.70000E+00 
1.80000E+00 1.90000E+00 2.00000E+00 2.10000E+00 2.20000E+00 2.30000E+00 
2.40000E+00 2.50000E+00 2.60000E+00 2.70000E+00 2.80000E+00 2.90000E+00 
3.00000E+00 3.10000E+00 3.20000E+00 3.30000E+00 3.40000E+00 3.50000E+00 
3.60000E+00 3.70000E+00 3.80000E+00 3.90000E+00 4.00000E+00 4.10000E+00 
4.20000E+00 4.30000E+00 4.40000E+00 4.50000E+00 4.60000E+00 4.70000E+00 
4.80000E+00 4.90000E+00 5.00000E+00 5.10000E+00 5.20000E+00 5.30000E+00 
5.40000E+00 5.50000E+00 5.60000E+00 5.70000E+00 5.80000E+00 5.90000E+00 
6.00000E+00 6.10000E+00 6.20000E+00 6.30000E+00 6.40000E+00 6.50000E+00 
6.60000E+00 6.70000E+00 6.80000E+00 6.90000E+00 7.00000E+00 7.10000E+00 
7.20000E+00 7.30000E+00 7.40000E+00 7.50000E+00 7.60000E+00 7.70000E+00 
7.80000E+00 7.90000E+00 8.00000E+00 8.10000E+00 8.20000E+00 8.30000E+00 
8.40000E+00 8.50000E+00 8.60000E+00 8.70000E+00 8.80000E+00 8.90000E+00 
9.00000E+00 9.10000E+00 9.20000E+00 9.30000E+00 9.40000E+00 9.50000E+00 
9.60000E+00 9.70000E+00 9.80000E+00 9.90000E+00 1.00000E+01 TERM
CREA YANA
0.00000E+00 1.54884E-05 3.13080E-03 1.96465E-02 5.06946E-02 9.10005E-02 
1.35778E-01 1.81937E-01 2.27688E-01 2.72059E-01 3.14554E-01 3.54955E-01 
3.93196E-01 4.29297E-01 4.63323E-01 4.95362E-01 5.25513E-01 5.53875E-01 
5.80551E-01 6.05635E-01 6.29223E-01 6.51401E-01 6.72253E-01 6.91858E-01 
7.10291E-01 7.27622E-01 7.43915E-01 7.59234E-01 7.73637E-01 7.87179E-01 
7.99910E-01 8.11879E-01 8.23133E-01 8.33713E-01 8.43661E-01 8.53013E-01 
8.61806E-01 8.70073E-01 8.77845E-01 8.85153E-01 8.92023E-01 8.98482E-01 
9.04555E-01 9.10265E-01 9.15633E-01 9.20680E-01 9.25425E-01 9.29886E-01 
9.34080E-01 9.38024E-01 9.41731E-01 9.45217E-01 9.48494E-01 9.51575E-01 
9.54472E-01 9.57195E-01 9.59756E-01 9.62164E-01 9.64427E-01 9.66555E-01 
9.68556E-01 9.70437E-01 9.72205E-01 9.73868E-01 9.75431E-01 9.76901E-01 
9.78283E-01 9.79582E-01 9.80803E-01 9.81952E-01 9.83031E-01 9.84046E-01 
9.85001E-01 9.85898E-01 9.86742E-01 9.87535E-01 9.88280E-01 9.88982E-01 
9.89641E-01 9.90260E-01 9.90843E-01 9.91391E-01 9.91906E-01 9.92390E-01 
9.92845E-01 9.93273E-01 9.93676E-01 9.94054E-01 9.94410E-01 9.94744E-01 
9.95059E-01 9.95354E-01 9.95632E-01 9.95893E-01 9.96139E-01 9.96370E-01 
9.96587E-01 9.96791E-01 9.96983E-01 9.97164E-01 9.97333E-01 TERM

COLOR BLUE CURV XANA YANA "analytic"

LABEL "time" VMIN 0.0 VMAX 10.0 AXIS X1
LABEL "u"    VMIN 0.0 VMAX  1.0 AXIS Y1

PSFN "doc/ucenter.ps"
DRAW CURV
